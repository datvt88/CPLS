# ğŸ“Š TÃ­nh nÄƒng TÃ­n hiá»‡u Golden Cross AI

## Tá»•ng quan

TÃ­nh nÄƒng **TÃ­n hiá»‡u Golden Cross AI** lÃ  má»™t cÃ´ng cá»¥ phÃ¢n tÃ­ch cá»• phiáº¿u tá»± Ä‘á»™ng, káº¿t há»£p:
- ğŸ“ˆ **PhÃ¢n tÃ­ch ká»¹ thuáº­t** (Technical Analysis)
- ğŸ’° **PhÃ¢n tÃ­ch cÆ¡ báº£n** (Fundamental Analysis)
- ğŸ¤– **ÄÃ¡nh giÃ¡ AI vá»›i Gemini**

Há»‡ thá»‘ng tá»± Ä‘á»™ng:
1. Láº¥y danh sÃ¡ch cá»• phiáº¿u cÃ³ tÃ­n hiá»‡u **Golden Cross** tá»« Firebase
2. Lá»c cÃ¡c cá»• phiáº¿u Ä‘áº¡t tiÃªu chuáº©n ká»¹ thuáº­t vÃ  cÆ¡ báº£n
3. Sá»­ dá»¥ng Gemini AI Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ chi tiáº¿t tá»«ng cá»• phiáº¿u
4. ÄÆ°a ra khuyáº¿n nghá»‹: **MUA**, **THEO DÃ•I**, hoáº·c **Bá» QUA**
5. LÆ°u cÃ¡c khuyáº¿n nghá»‹ "MUA" vÃ o Firebase Ä‘á»ƒ theo dÃµi hiá»‡u quáº£

---

## ğŸ¯ TÃ­nh nÄƒng chÃ­nh

### 1. Widget Golden Cross Signals
**Vá»‹ trÃ­:** `/signals` (Premium only)

**Chá»©c nÄƒng:**
- Hiá»ƒn thá»‹ danh sÃ¡ch cá»• phiáº¿u cÃ³ tÃ­n hiá»‡u Golden Cross
- Tá»± Ä‘á»™ng lá»c theo tiÃªu chÃ­:
  - âœ… MA10 > MA30 (Golden Cross Ä‘Ã£ xáº£y ra hoáº·c xu hÆ°á»›ng tÄƒng)
  - âœ… P/E dÆ°Æ¡ng vÃ  há»£p lÃ½ (< 25)
  - âœ… P/B < 3
  - âœ… ROE > 10%
  - âœ… ROE cÃ³ xu hÆ°á»›ng cáº£i thiá»‡n (náº¿u cÃ³ dá»¯ liá»‡u chi tiáº¿t)

**Thao tÃ¡c:**
- ğŸ¤– **ÄÃ¡nh giÃ¡ AI**: PhÃ¢n tÃ­ch tá»«ng cá»• phiáº¿u vá»›i Gemini
- ğŸ¤– **PhÃ¢n tÃ­ch táº¥t cáº£ vá»›i AI**: Tá»± Ä‘á»™ng phÃ¢n tÃ­ch toÃ n bá»™ danh sÃ¡ch
- ğŸ’¾ **LÆ°u khuyáº¿n nghá»‹**: LÆ°u cÃ¡c cá»• phiáº¿u "MUA" vÃ o Firebase

**Káº¿t quáº£ AI bao gá»“m:**
- âš¡ TÃ­n hiá»‡u ngáº¯n háº¡n (1-4 tuáº§n) vá»›i Ä‘á»™ tin cáº­y
- ğŸ¯ TÃ­n hiá»‡u dÃ i háº¡n (3-12 thÃ¡ng) vá»›i Ä‘á»™ tin cáº­y
- ğŸ’° GiÃ¡ má»¥c tiÃªu (Target Price)
- ğŸ›‘ Má»©c cáº¯t lá»— (Stop Loss)
- âš ï¸ Rá»§i ro
- ğŸ’¡ CÆ¡ há»™i

---

### 2. Widget Recommendations Performance
**Vá»‹ trÃ­:** `/signals` (Premium only)

**Chá»©c nÄƒng:**
- Hiá»ƒn thá»‹ táº¥t cáº£ khuyáº¿n nghá»‹ "MUA" Ä‘Ã£ lÆ°u
- So sÃ¡nh giÃ¡ khuyáº¿n nghá»‹ vs giÃ¡ hiá»‡n táº¡i
- TÃ­nh toÃ¡n lá»£i nhuáº­n/lá»— theo thá»i gian thá»±c
- Thá»‘ng kÃª hiá»‡u quáº£ tá»•ng thá»ƒ:
  - Tá»· lá»‡ tháº¯ng (Win Rate)
  - Lá»£i nhuáº­n trung bÃ¬nh
  - Khuyáº¿n nghá»‹ tá»‘t nháº¥t / tá»‡ nháº¥t

**Bá»™ lá»c:**
- ğŸ”µ **Táº¥t cáº£**: Hiá»ƒn thá»‹ toÃ n bá»™ khuyáº¿n nghá»‹
- ğŸ”µ **Äang theo dÃµi**: CÃ¡c khuyáº¿n nghá»‹ chÆ°a Ä‘áº¡t má»¥c tiÃªu hoáº·c cáº¯t lá»—
- ğŸŸ¢ **Äáº¡t má»¥c tiÃªu**: GiÃ¡ Ä‘Ã£ Ä‘áº¡t Target Price
- ğŸ”´ **Cáº¯t lá»—**: GiÃ¡ Ä‘Ã£ cháº¡m Stop Loss

**Thao tÃ¡c:**
- ğŸ”„ **Cáº­p nháº­t giÃ¡**: Láº¥y giÃ¡ hiá»‡n táº¡i tá»« VNDirect cho táº¥t cáº£ khuyáº¿n nghá»‹

---

## ğŸ”§ Cáº¥u trÃºc ká»¹ thuáº­t

### Services
**File:** `services/goldenCross.service.ts`

**Functions:**
```typescript
// Láº¥y danh sÃ¡ch cá»• phiáº¿u Golden Cross tá»« Firebase
getGoldenCrossStocks(): Promise<GoldenCrossStock[]>

// LÆ°u khuyáº¿n nghá»‹ MUA
saveBuyRecommendation(recommendation): Promise<string>

// Láº¥y danh sÃ¡ch khuyáº¿n nghá»‹ (cÃ³ thá»ƒ lá»c theo status)
getBuyRecommendations(status?): Promise<StockRecommendation[]>

// Cáº­p nháº­t status vÃ  giÃ¡ hiá»‡n táº¡i
updateRecommendationStatus(id, currentPrice, status?): Promise<void>

// TÃ­nh toÃ¡n metrics hiá»‡u quáº£
calculatePerformanceMetrics(): Promise<PerformanceMetrics>

// Tá»± Ä‘á»™ng cáº­p nháº­t giÃ¡ cho táº¥t cáº£ khuyáº¿n nghá»‹ active
updateAllRecommendationsWithCurrentPrices(): Promise<void>
```

---

### API Endpoints

#### 1. GET `/api/signals/golden-cross`
Láº¥y danh sÃ¡ch cá»• phiáº¿u Golden Cross tá»« Firebase.

**Response:**
```json
{
  "success": true,
  "count": 15,
  "data": [
    {
      "symbol": "VNM",
      "date": "2025-12-03T00:00:00Z",
      "ma10": 85000,
      "ma30": 83000,
      "price": 86000,
      "volume": 5000000,
      "crossDate": "2025-12-01"
    }
  ]
}
```

---

#### 2. POST `/api/signals/batch-analysis`
PhÃ¢n tÃ­ch batch nhiá»u cá»• phiáº¿u, lá»c nhá»¯ng cá»• phiáº¿u Ä‘áº¡t tiÃªu chuáº©n.

**Request:**
```json
{
  "symbols": ["VNM", "HPG", "VIC", "VCB"]
}
```

**Response:**
```json
{
  "success": true,
  "total": 4,
  "filtered": 2,
  "data": [
    {
      "symbol": "VNM",
      "currentPrice": 86000,
      "ma10": 85000,
      "ma30": 83000,
      "pe": 18.5,
      "pb": 2.1,
      "roe": 25.3,
      "fundamentalScore": 4,
      "fundamentalReasons": [
        "P/E: 18.50",
        "P/B: 2.10",
        "ROE: 25.30%",
        "ROE cáº£i thiá»‡n: 26.20%"
      ]
    }
  ]
}
```

---

#### 3. GET/POST/PATCH `/api/signals/recommendations`

**GET** - Láº¥y danh sÃ¡ch khuyáº¿n nghá»‹
```
GET /api/signals/recommendations
GET /api/signals/recommendations?status=active
```

**POST** - LÆ°u khuyáº¿n nghá»‹ má»›i
```json
{
  "symbol": "VNM",
  "recommendedPrice": 86000,
  "currentPrice": 86000,
  "targetPrice": "95,000 - 100,000",
  "stopLoss": "82,000",
  "confidence": 75,
  "aiSignal": "MUA",
  "technicalAnalysis": ["MA10 > MA30", "..."],
  "fundamentalAnalysis": ["P/E: 18.5", "..."],
  "risks": ["..."],
  "opportunities": ["..."]
}
```

**PATCH** - Cáº­p nháº­t status vÃ  giÃ¡
```json
{
  "id": "rec_123",
  "currentPrice": 88000,
  "status": "active"
}
```

---

### Components

#### 1. `GoldenCrossSignalsWidget.tsx`
**Props:** None (fetches data internally)

**State:**
- `stocks`: Danh sÃ¡ch cá»• phiáº¿u Ä‘Ã£ lá»c
- `analyzingAll`: Äang phÃ¢n tÃ­ch táº¥t cáº£ vá»›i AI
- `selectedStocks`: CÃ¡c cá»• phiáº¿u Ä‘Æ°á»£c chá»n

**Features:**
- Tá»± Ä‘á»™ng lá»c cá»• phiáº¿u Ä‘áº¡t tiÃªu chuáº©n
- PhÃ¢n tÃ­ch tá»«ng cá»• phiáº¿u hoáº·c toÃ n bá»™ vá»›i Gemini
- Hiá»ƒn thá»‹ káº¿t quáº£ AI Ä‘áº§y Ä‘á»§
- LÆ°u khuyáº¿n nghá»‹ "MUA" vÃ o Firebase

---

#### 2. `RecommendationsPerformanceWidget.tsx`
**Props:** None

**State:**
- `recommendations`: Danh sÃ¡ch khuyáº¿n nghá»‹
- `metrics`: Metrics tá»•ng há»£p
- `filterStatus`: Bá»™ lá»c (all/active/completed/stopped)
- `updating`: Äang cáº­p nháº­t giÃ¡

**Features:**
- Hiá»ƒn thá»‹ metrics tá»•ng quan
- Lá»c theo status
- TÃ­nh toÃ¡n lá»£i nhuáº­n real-time
- Cáº­p nháº­t giÃ¡ hÃ ng loáº¡t

---

## ğŸ“¦ Cáº¥u trÃºc dá»¯ liá»‡u Firebase

### Node: `goldenCross`
```
goldenCross/
  â”œâ”€â”€ VNM/
  â”‚   â”œâ”€â”€ symbol: "VNM"
  â”‚   â”œâ”€â”€ date: "2025-12-03T..."
  â”‚   â”œâ”€â”€ ma10: 85000
  â”‚   â”œâ”€â”€ ma30: 83000
  â”‚   â”œâ”€â”€ price: 86000
  â”‚   â”œâ”€â”€ volume: 5000000
  â”‚   â””â”€â”€ crossDate: "2025-12-01"
  â”œâ”€â”€ HPG/
  â”‚   â””â”€â”€ ...
```

### Node: `buyRecommendations`
```
buyRecommendations/
  â”œâ”€â”€ -N1abc123/
  â”‚   â”œâ”€â”€ symbol: "VNM"
  â”‚   â”œâ”€â”€ recommendedPrice: 86000
  â”‚   â”œâ”€â”€ currentPrice: 88000
  â”‚   â”œâ”€â”€ targetPrice: "95,000 - 100,000"
  â”‚   â”œâ”€â”€ stopLoss: "82,000"
  â”‚   â”œâ”€â”€ confidence: 75
  â”‚   â”œâ”€â”€ aiSignal: "MUA"
  â”‚   â”œâ”€â”€ technicalAnalysis: [...]
  â”‚   â”œâ”€â”€ fundamentalAnalysis: [...]
  â”‚   â”œâ”€â”€ risks: [...]
  â”‚   â”œâ”€â”€ opportunities: [...]
  â”‚   â”œâ”€â”€ createdAt: "2025-12-03T..."
  â”‚   â”œâ”€â”€ lastUpdated: "2025-12-03T..."
  â”‚   â””â”€â”€ status: "active"
```

---

## ğŸ” Biáº¿n mÃ´i trÆ°á»ng

Cáº§n thÃªm vÃ o **Vercel Environment Variables**:

```env
# Firebase Realtime Database
FIREBASE_URL=https://your-project-default-rtdb.region.firebasedatabase.app
FIREBASE_SECRET=your_firebase_database_secret
```

**Láº¥y credentials:**
1. VÃ o [Firebase Console](https://console.firebase.google.com/)
2. Chá»n project
3. VÃ o **Realtime Database**
4. Copy **Database URL** â†’ `FIREBASE_URL`
5. VÃ o **Project Settings > Service Accounts > Database Secrets**
6. Táº¡o hoáº·c copy secret â†’ `FIREBASE_SECRET`

---

## ğŸ’¡ Äá» xuáº¥t tá»‘i Æ°u

### 1. **Automation vá»›i Cron Jobs**
Táº¡o API endpoint `/api/cron/update-golden-cross` Ä‘á»ƒ:
- Tá»± Ä‘á»™ng quÃ©t thá»‹ trÆ°á»ng tÃ¬m Golden Cross má»—i ngÃ y
- Cáº­p nháº­t Firebase vá»›i danh sÃ¡ch má»›i
- Gá»­i thÃ´ng bÃ¡o cho Premium users

**Vercel Cron:**
```json
// vercel.json
{
  "crons": [
    {
      "path": "/api/cron/update-golden-cross",
      "schedule": "0 17 * * 1-5"  // 5PM má»—i ngÃ y tá»« T2-T6
    },
    {
      "path": "/api/cron/update-recommendations",
      "schedule": "0 9,15 * * 1-5"  // 9AM vÃ  3PM
    }
  ]
}
```

---

### 2. **Real-time Alerts vá»›i ZNS**
Gá»­i thÃ´ng bÃ¡o Zalo khi:
- âœ… CÃ³ cá»• phiáº¿u Golden Cross má»›i
- âœ… Khuyáº¿n nghá»‹ Ä‘áº¡t target price
- âš ï¸ Khuyáº¿n nghá»‹ cháº¡m stop loss
- ğŸ“Š BÃ¡o cÃ¡o hiá»‡u quáº£ hÃ ng tuáº§n

---

### 3. **Advanced Filtering**
ThÃªm bá»™ lá»c nÃ¢ng cao:
- Volume spike (khá»‘i lÆ°á»£ng báº¥t thÆ°á»ng)
- News sentiment analysis
- Industry sector filtering
- Market cap ranges
- Liquidity metrics

---

### 4. **Backtesting**
Táº¡o tool backtesting Ä‘á»ƒ:
- Test chiáº¿n lÆ°á»£c trÃªn dá»¯ liá»‡u lá»‹ch sá»­
- ÄÃ¡nh giÃ¡ Ä‘á»™ chÃ­nh xÃ¡c cá»§a AI
- Optimize cÃ¡c threshold
- A/B testing cÃ¡c models

---

### 5. **Portfolio Tracking**
TÃ­ch há»£p theo dÃµi portfolio:
- User tá»± thÃªm cá»• phiáº¿u Ä‘ang náº¯m giá»¯
- TÃ­nh P&L tá»•ng thá»ƒ
- Cáº£nh bÃ¡o khi cáº§n rebalance
- Äá» xuáº¥t mua/bÃ¡n dá»±a trÃªn AI

---

### 6. **Social Features**
- Chia sáº» khuyáº¿n nghá»‹ vá»›i cá»™ng Ä‘á»“ng
- Voting vÃ  comment
- Leaderboard top analysts
- Copy trading (theo dÃµi khuyáº¿n nghá»‹ cá»§a ngÆ°á»i khÃ¡c)

---

### 7. **Mobile App**
PhÃ¡t triá»ƒn mobile app vá»›i:
- Push notifications
- Quick actions
- Biá»ƒu Ä‘á»“ tÆ°Æ¡ng tÃ¡c
- Offline support

---

### 8. **Advanced AI Models**
- Ensemble models (káº¿t há»£p nhiá»u AI)
- Sentiment analysis tá»« tin tá»©c
- Predictive analytics
- Risk assessment scoring

---

### 9. **Data Visualization**
ThÃªm biá»ƒu Ä‘á»“:
- Performance over time
- Risk/Return scatter plot
- Sector allocation
- Win rate trends

---

### 10. **Educational Content**
Táº¡o ná»™i dung hÆ°á»›ng dáº«n:
- Video tutorials
- Strategy guides
- Risk management tips
- Market insights blog

---

## ğŸš€ HÆ°á»›ng dáº«n sá»­ dá»¥ng

### Cho Premium Users:

1. **Truy cáº­p trang TÃ­n hiá»‡u:**
   - VÃ o `/signals` (chá»‰ Premium users)

2. **Xem danh sÃ¡ch Golden Cross:**
   - Há»‡ thá»‘ng tá»± Ä‘á»™ng hiá»ƒn thá»‹ cá»• phiáº¿u Ä‘áº¡t tiÃªu chuáº©n
   - Xem chá»‰ sá»‘ ká»¹ thuáº­t vÃ  cÆ¡ báº£n

3. **ÄÃ¡nh giÃ¡ vá»›i AI:**
   - Click **"ğŸ¤– ÄÃ¡nh giÃ¡ AI"** cho tá»«ng cá»• phiáº¿u
   - Hoáº·c **"ğŸ¤– PhÃ¢n tÃ­ch táº¥t cáº£ vá»›i AI"** cho toÃ n bá»™

4. **LÆ°u khuyáº¿n nghá»‹:**
   - Vá»›i cá»• phiáº¿u cÃ³ khuyáº¿n nghá»‹ **"MUA"**
   - Click **"ğŸ’¾ LÆ°u khuyáº¿n nghá»‹"**

5. **Theo dÃµi hiá»‡u quáº£:**
   - Xem widget **"Hiá»‡u quáº£ Khuyáº¿n nghá»‹"**
   - Click **"ğŸ”„ Cáº­p nháº­t giÃ¡"** Ä‘á»ƒ refresh
   - Lá»c theo status Ä‘á»ƒ xem chi tiáº¿t

---

### Cho Developers:

1. **Setup Firebase:**
   ```bash
   # ThÃªm vÃ o .env.local
   FIREBASE_URL=https://...
   FIREBASE_SECRET=...
   ```

2. **Cáº¥u trÃºc data Firebase:**
   - Táº¡o node `goldenCross` vá»›i cáº¥u trÃºc nhÆ° trÃªn
   - Node `buyRecommendations` sáº½ tá»± táº¡o khi cÃ³ lÆ°u

3. **Test endpoints:**
   ```bash
   # Get golden cross
   curl http://localhost:3000/api/signals/golden-cross

   # Batch analysis
   curl -X POST http://localhost:3000/api/signals/batch-analysis \
     -H "Content-Type: application/json" \
     -d '{"symbols":["VNM","HPG"]}'

   # Get recommendations
   curl http://localhost:3000/api/signals/recommendations
   ```

4. **Deploy lÃªn Vercel:**
   - ThÃªm environment variables
   - Push code
   - Verify hoáº¡t Ä‘á»™ng

---

## âš ï¸ LÆ°u Ã½ quan trá»ng

1. **Rate Limiting:**
   - Gemini API cÃ³ rate limit
   - ThÃªm delay 2s giá»¯a cÃ¡c requests khi phÃ¢n tÃ­ch hÃ ng loáº¡t

2. **Error Handling:**
   - Táº¥t cáº£ API calls Ä‘á»u cÃ³ try-catch
   - Fallback khi thiáº¿u dá»¯ liá»‡u

3. **Security:**
   - Firebase rules cáº§n setup Ä‘Ãºng
   - Chá»‰ Premium users Ä‘Æ°á»£c truy cáº­p `/signals`

4. **Performance:**
   - Cache results khi cÃ³ thá»ƒ
   - Lazy load components
   - Optimize Firebase queries

---

## ğŸ“ Support

Náº¿u cÃ³ váº¥n Ä‘á», liÃªn há»‡:
- GitHub Issues
- Email support
- Zalo group

---

**Version:** 1.0.0
**Last Updated:** 2025-12-03
**Author:** Claude AI + datvt88
